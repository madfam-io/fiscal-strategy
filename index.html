<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MADFAM Strategy Center</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Config for Dark Mode -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    padding: {
                        'safe': 'env(safe-area-inset-bottom)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            -webkit-tap-highlight-color: transparent;
        }
        /* Hide scrollbar for cleaner mobile look */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-slate-50 dark:bg-slate-950 transition-colors duration-300">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icons (Embedded SVGs for single-file reliability) ---
        
        const IconWrapper = ({ children, size = 24, className = "" }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const Zap = (props) => <IconWrapper {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></IconWrapper>;
        const CheckCircle = (props) => <IconWrapper {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></IconWrapper>;
        const AlertTriangle = (props) => <IconWrapper {...props}><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></IconWrapper>;
        // We only really need Zap, CheckCircle and AlertTriangle for the UI logic, 
        // the rest are used as emoji in the data or UI.

        // --- Data ---

        const strategyData = {
            urgent: [
                {
                    title: 'The "Golden Ticket" (C√©dula de Validaci√≥n)',
                    icon: 'üé´',
                    what: 'Certificate from SDEyT Morelos.',
                    why: 'Unlocks ~14.75% fixed rate. Without it, you pay ~25%.',
                    action: 'Go to SDEyT in Cuernavaca ASAP.',
                    deadline: 'December 31, 2025'
                },
                {
                    title: 'Clean Bill of Health (32-D)',
                    icon: 'ü©∫',
                    what: 'SAT Positive Compliance Opinion.',
                    why: 'If negative (even 1 peso), NO government loans for you.',
                    action: 'Download from SAT portal.',
                    deadline: 'Immediate'
                },
                {
                    title: 'RENIECYT Registration',
                    icon: 'üß¨',
                    what: 'Register for Tech/Innovation entities.',
                    why: 'Required for the 30% Tax Credit in 2026.',
                    action: 'Check status or register.',
                    deadline: 'Before Feb 2026'
                }
            ],
            loans: [
                {
                    title: 'Fondo Morelos "ProPyME Premium"',
                    vibe: 'Best Rate (Slow)',
                    amount: 'Up to $8,000,000 MXN',
                    rate: 'Starts at 9.5% üìâ',
                    bestFor: 'Machinery, Construction.',
                    catch: 'Requires Mortgage Guarantee.',
                    color: 'bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800'
                },
                {
                    title: 'Program "Fortalece"',
                    vibe: 'Quick Cash ‚ö°',
                    amount: '$10k - $150k MXN',
                    rate: '12% (Prompt Payment)',
                    bestFor: 'Aguinaldos, Inventory.',
                    catch: 'Smaller amounts only.',
                    color: 'bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800'
                },
                {
                    title: 'NAFIN "Impulso + Morelos"',
                    vibe: 'The Big Commercial Loan üè¶',
                    amount: 'Up to $5,000,000 MXN',
                    rate: 'Capped at 14.75% Fixed',
                    bestFor: 'Working Capital, Expansion.',
                    catch: 'Needs the "Golden Ticket" (C√©dula) first.',
                    color: 'bg-purple-50 border-purple-200 dark:bg-purple-900/20 dark:border-purple-800'
                }
            ],
            grants: [
                {
                    title: 'Fiscal Stimulus (EFIDT 2026)',
                    icon: 'üî¨',
                    reward: '30% Tax Credit on R&D spend.',
                    strategy: 'Classify engineering salaries/prototypes as R&D.'
                },
                {
                    title: 'Social Economy "Bienestar"',
                    icon: 'ü§ù',
                    reward: 'Up to $50k Grant (Free Money).',
                    note: 'Watch for calls in Jan/Feb 2026.'
                },
                {
                    title: 'Green Energy Financing',
                    icon: '‚òÄÔ∏è',
                    reward: 'Subsidized Solar Panels.',
                    note: 'New for 2026. Wait for Jan launch to buy panels.'
                }
            ],
            logistics: [
                {
                    title: 'FedEx x Secretary of Economy',
                    icon: 'üì¶',
                    detail: '40% Discount on shipping if you have "Hecho en M√©xico" cert.'
                }
            ],
            warnings: [
                {
                    title: 'NO Advance Deposits',
                    detail: 'If they ask for money for "insurance" or "file opening", it is a SCAM.',
                    icon: 'üö©'
                },
                {
                    title: 'Check the URL',
                    detail: 'Only trust websites ending in .gob.mx',
                    icon: 'üîó'
                },
                {
                    title: 'Avoid "Instant" Loans',
                    detail: 'If they don\'t check Credit Bureau, it\'s a shark (80%+ interest).',
                    icon: 'ü¶à'
                }
            ]
        };

        const initialTodoList = [
            { id: 1, phase: 'Phase 1: Urgent (Dec 13-31)', text: 'Validate Tax Compliance (SAT 32-D Positive)', done: false },
            { id: 2, phase: 'Phase 1: Urgent (Dec 13-31)', text: 'Download Constancia de Situaci√≥n Fiscal (<30 days old)', done: false },
            { id: 3, phase: 'Phase 1: Urgent (Dec 13-31)', text: 'GO TO CUERNAVACA: Get SDEyT "C√©dula de Validaci√≥n"', done: false },
            { id: 4, phase: 'Phase 1: Urgent (Dec 13-31)', text: 'Message Fondo Morelos (WhatsApp) about leftover budget', done: false },
            { id: 5, phase: 'Phase 1: Urgent (Dec 13-31)', text: 'Verify RENIECYT Status (for Innovation tax credit)', done: false },
            { id: 6, phase: 'Phase 2: Execution (Jan 2-31)', text: 'Submit Bank Application (Impulso NAFIN) with C√©dula', done: false },
            { id: 7, phase: 'Phase 2: Execution (Jan 2-31)', text: 'Monitor "Tierra y Libertad" for Bienestar rules', done: false },
            { id: 8, phase: 'Phase 2: Execution (Jan 2-31)', text: 'Prepare Technical Project description for EFIDT', done: false },
            { id: 9, phase: 'Risk Control (Always)', text: 'Check consultants against CONDUSEF SIPRES', done: false },
            { id: 10, phase: 'Risk Control (Always)', text: 'Avoid Fintech loans for long-term machines', done: false },
        ];

        // --- Components ---

        const Card = ({ children, className = "" }) => (
            <div className={`bg-white dark:bg-slate-800 rounded-2xl shadow-sm border-2 border-slate-100 dark:border-slate-700 p-5 mb-4 ${className}`}>
                {children}
            </div>
        );

        const Badge = ({ children, color = "bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-200" }) => (
            <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold uppercase tracking-wide ${color}`}>
                {children}
            </span>
        );

        const SectionHeader = ({ icon, title, subtitle }) => (
            <div className="mb-6 mt-8">
                <div className="flex items-center gap-2 mb-1">
                    <span className="text-3xl filter drop-shadow-sm">{icon}</span>
                    <h2 className="text-2xl font-black text-slate-800 dark:text-slate-100 tracking-tight">{title}</h2>
                </div>
                {subtitle && <p className="text-slate-500 dark:text-slate-400 font-medium ml-1">{subtitle}</p>}
            </div>
        );

        // --- Main App ---

        function App() {
            const [activeTab, setActiveTab] = useState('guide');
            const [todos, setTodos] = useState(initialTodoList);
            const [progress, setProgress] = useState(0);
            const [isDarkMode, setIsDarkMode] = useState(false);

            // Auto-detect system theme
            useEffect(() => {
                if (typeof window !== 'undefined' && window.matchMedia) {
                    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
                    setIsDarkMode(mediaQuery.matches);
                    
                    const handleChange = (e) => setIsDarkMode(e.matches);
                    mediaQuery.addEventListener('change', handleChange);
                    return () => mediaQuery.removeEventListener('change', handleChange);
                }
            }, []);

            // Load state from local storage on mount
            useEffect(() => {
                const savedTodos = localStorage.getItem('madfam_todos');
                if (savedTodos) {
                    setTodos(JSON.parse(savedTodos));
                }
            }, []);

            // Update progress whenever todos change
            useEffect(() => {
                const completed = todos.filter(t => t.done).length;
                const total = todos.length;
                setProgress(Math.round((completed / total) * 100));
                localStorage.setItem('madfam_todos', JSON.stringify(todos));
            }, [todos]);

            const toggleTodo = (id) => {
                setTodos(todos.map(t => t.id === id ? { ...t, done: !t.done } : t));
            };

            const GuideView = () => (
                <div className="space-y-4 pb-24 animate-in fade-in duration-500">
                    
                    {/* Introduction Card */}
                    <Card className="bg-gradient-to-br from-indigo-600 to-purple-700 text-white border-none dark:from-indigo-900 dark:to-purple-950">
                        <h1 className="text-3xl font-extrabold mb-2">Innovaciones MADFAM</h1>
                        <p className="text-indigo-100 font-medium text-lg">
                            2025-2026 Strategic Headquarters
                        </p>
                        <div className="mt-4 flex flex-wrap gap-2">
                            <Badge color="bg-white/20 text-white">Morelos, MX</Badge>
                            <Badge color="bg-white/20 text-white">Late 2025</Badge>
                        </div>
                    </Card>

                    {/* URGENT SECTION */}
                    <SectionHeader icon="üö®" title="Urgent: December" subtitle="Do this before holidays!" />
                    <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                        {strategyData.urgent.map((item, idx) => (
                            <Card key={idx} className="border-l-8 border-l-red-500 bg-red-50/50 dark:bg-red-900/10 dark:border-l-red-600">
                                <div className="flex justify-between items-start">
                                    <span className="text-4xl mb-3 block">{item.icon}</span>
                                    <Badge color="bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200 font-bold">{item.deadline}</Badge>
                                </div>
                                <h3 className="font-bold text-xl text-slate-900 dark:text-slate-100 leading-tight mb-2">{item.title}</h3>
                                <p className="text-sm text-slate-700 dark:text-slate-300 font-semibold mb-2">{item.what}</p>
                                <div className="bg-white/60 dark:bg-black/20 p-3 rounded-lg border border-red-100 dark:border-red-900/50">
                                    <p className="text-xs font-bold text-red-600 dark:text-red-400 uppercase mb-1">Why Critical:</p>
                                    <p className="text-sm text-slate-700 dark:text-slate-300">{item.why}</p>
                                </div>
                            </Card>
                        ))}
                    </div>

                    {/* MONEY SECTION */}
                    <SectionHeader icon="üí∞" title="State & Federal Loans" subtitle="The 'Good' Debt" />
                    <div className="space-y-4">
                        {strategyData.loans.map((loan, idx) => (
                            <Card key={idx} className={`${loan.color} transition-transform active:scale-[0.98]`}>
                                <div className="flex justify-between items-start mb-2">
                                    <Badge color="bg-white/80 dark:bg-black/20 shadow-sm text-slate-800 dark:text-slate-200">{loan.vibe}</Badge>
                                    <span className="font-black text-xl text-slate-700 dark:text-slate-200">{loan.rate}</span>
                                </div>
                                <h3 className="text-2xl font-black text-slate-900 dark:text-slate-100 mb-2">{loan.title}</h3>
                                <div className="grid grid-cols-2 gap-2 text-sm">
                                    <div className="bg-white/60 dark:bg-black/20 p-2 rounded">
                                        <p className="text-xs text-slate-500 dark:text-slate-400 uppercase font-bold">Amount</p>
                                        <p className="font-bold text-slate-800 dark:text-slate-200">{loan.amount}</p>
                                    </div>
                                    <div className="bg-white/60 dark:bg-black/20 p-2 rounded">
                                        <p className="text-xs text-slate-500 dark:text-slate-400 uppercase font-bold">Best For</p>
                                        <p className="font-bold text-slate-800 dark:text-slate-200">{loan.bestFor}</p>
                                    </div>
                                </div>
                                {loan.catch && (
                                    <div className="mt-3 flex items-start gap-2 text-xs font-bold text-amber-700 dark:text-amber-400 bg-amber-100/50 dark:bg-amber-900/30 p-2 rounded">
                                        <AlertTriangle size={14} className="mt-0.5 shrink-0" />
                                        {loan.catch}
                                    </div>
                                )}
                            </Card>
                        ))}
                    </div>

                    {/* GRANTS SECTION */}
                    <SectionHeader icon="üéÅ" title="Free Money & Perks" subtitle="Grants, Tax Credits & Logistics" />
                    <div className="grid gap-4 md:grid-cols-2">
                        {strategyData.grants.map((grant, idx) => (
                            <Card key={idx}>
                                <div className="flex items-center gap-3 mb-3">
                                    <span className="text-3xl bg-indigo-50 dark:bg-indigo-900/30 p-2 rounded-lg">{grant.icon}</span>
                                    <h3 className="font-bold text-lg leading-tight dark:text-slate-100">{grant.title}</h3>
                                </div>
                                <p className="text-slate-600 dark:text-slate-300 mb-3">{grant.reward}</p>
                                {grant.strategy && (
                                    <div className="bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200 text-sm p-3 rounded-lg font-medium">
                                        üí° Tip: {grant.strategy}
                                    </div>
                                )}
                                {grant.note && (
                                    <div className="bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 text-sm p-3 rounded-lg font-medium">
                                        üóìÔ∏è {grant.note}
                                    </div>
                                )}
                            </Card>
                        ))}
                        {strategyData.logistics.map((item, idx) => (
                            <Card key={`log-${idx}`}>
                                <div className="flex items-center gap-3 mb-3">
                                    <span className="text-3xl bg-orange-50 dark:bg-orange-900/20 p-2 rounded-lg">{item.icon}</span>
                                    <h3 className="font-bold text-lg leading-tight dark:text-slate-100">{item.title}</h3>
                                </div>
                                <p className="text-slate-800 dark:text-slate-200 font-medium">{item.detail}</p>
                            </Card>
                        ))}
                    </div>

                    {/* RED FLAGS */}
                    <SectionHeader icon="üö´" title="Red Flags" subtitle="Do NOT get scammed" />
                    <div className="space-y-3">
                        {strategyData.warnings.map((warn, idx) => (
                            <div key={idx} className="bg-red-50 dark:bg-red-900/20 border-2 border-red-100 dark:border-red-900 rounded-xl p-4 flex items-start gap-4">
                                <span className="text-3xl">{warn.icon}</span>
                                <div>
                                    <h4 className="font-bold text-red-900 dark:text-red-200">{warn.title}</h4>
                                    <p className="text-red-800 dark:text-red-300 text-sm leading-snug">{warn.detail}</p>
                                </div>
                            </div>
                        ))}
                    </div>

                    {/* FUTURE */}
                    <SectionHeader icon="üîÆ" title="2026 Forecast" subtitle="Looking ahead" />
                    <div className="grid gap-3 grid-cols-1 md:grid-cols-3 mb-8">
                        <div className="bg-slate-100 dark:bg-slate-800 p-4 rounded-xl">
                            <h4 className="font-bold text-slate-700 dark:text-slate-200 mb-1">üìà Taxes Up</h4>
                            <p className="text-sm text-slate-600 dark:text-slate-400">State payroll tax increasing. Need subsidized loans to offset.</p>
                        </div>
                        <div className="bg-slate-100 dark:bg-slate-800 p-4 rounded-xl">
                            <h4 className="font-bold text-slate-700 dark:text-slate-200 mb-1">üèóÔ∏è Infrastructure</h4>
                            <p className="text-sm text-slate-600 dark:text-slate-400">"Plan M√©xico" improving logistics corridors in Cuernavaca.</p>
                        </div>
                        <div className="bg-slate-100 dark:bg-slate-800 p-4 rounded-xl">
                            <h4 className="font-bold text-slate-700 dark:text-slate-200 mb-1">‚öΩ World Cup</h4>
                            <p className="text-sm text-slate-600 dark:text-slate-400">Innovation challenges coming from Santander/Universities.</p>
                        </div>
                    </div>
                </div>
            );

            const ChecklistView = () => (
                <div className="pb-24 animate-in slide-in-from-right duration-300">
                    
                    <Card className="bg-indigo-900 dark:bg-indigo-950 text-white mb-6 sticky top-0 z-10 shadow-lg border-indigo-800">
                        <div className="flex justify-between items-end mb-2">
                            <h2 className="text-2xl font-bold">Action Plan</h2>
                            <span className="text-2xl font-mono font-bold text-green-400">{progress}%</span>
                        </div>
                        <div className="w-full bg-indigo-950 dark:bg-black/50 rounded-full h-3">
                            <div 
                                className="bg-green-400 h-3 rounded-full transition-all duration-500 ease-out" 
                                style={{ width: `${progress}%` }}
                            />
                        </div>
                        <p className="text-xs text-indigo-300 mt-2 text-center">Progress saves automatically</p>
                    </Card>

                    <div className="space-y-2">
                        {['Phase 1: Urgent (Dec 13-31)', 'Phase 2: Execution (Jan 2-31)', 'Risk Control (Always)'].map((phaseTitle) => (
                            <div key={phaseTitle} className="mb-6">
                                <h3 className="text-sm font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-3 px-1">{phaseTitle}</h3>
                                {todos.filter(t => t.phase === phaseTitle).map((todo) => (
                                    <div 
                                        key={todo.id}
                                        onClick={() => toggleTodo(todo.id)}
                                        className={`
                                            group flex items-start gap-4 p-4 mb-3 rounded-xl border-2 cursor-pointer transition-all duration-200
                                            ${todo.done 
                                                ? 'bg-slate-50 dark:bg-slate-800/50 border-slate-200 dark:border-slate-700/50 opacity-60' 
                                                : 'bg-white dark:bg-slate-800 border-indigo-100 dark:border-slate-700 hover:border-indigo-400 dark:hover:border-indigo-500 shadow-sm'}
                                        `}
                                    >
                                        <div className={`
                                            mt-1 w-6 h-6 rounded-full border-2 flex items-center justify-center shrink-0 transition-colors
                                            ${todo.done ? 'bg-green-500 border-green-500' : 'bg-white dark:bg-slate-700 border-slate-300 dark:border-slate-600 group-hover:border-indigo-400'}
                                        `}>
                                            {todo.done && <CheckCircle size={16} className="text-white" />}
                                        </div>
                                        <p className={`text-lg font-medium leading-snug select-none ${todo.done ? 'line-through text-slate-500 dark:text-slate-500' : 'text-slate-800 dark:text-slate-200'}`}>
                                            {todo.text}
                                        </p>
                                    </div>
                                ))}
                            </div>
                        ))}
                    </div>
                </div>
            );

            return (
                <div className={isDarkMode ? 'dark' : ''}>
                    <div className="min-h-screen bg-slate-50 dark:bg-slate-950 font-sans text-slate-900 dark:text-slate-100 selection:bg-indigo-200 dark:selection:bg-indigo-500/30 transition-colors duration-300">
                        <div className="max-w-3xl mx-auto px-4 py-6">
                            {/* Main Content Area */}
                            {activeTab === 'guide' ? <GuideView /> : <ChecklistView />}
                        </div>

                        {/* Bottom Navigation */}
                        <div className="fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 p-2 pb-safe shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] z-50">
                            <div className="max-w-md mx-auto grid grid-cols-2 gap-2">
                                <button
                                    onClick={() => setActiveTab('guide')}
                                    className={`
                                        flex flex-col items-center justify-center p-3 rounded-xl transition-colors
                                        ${activeTab === 'guide' ? 'bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300' : 'text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800'}
                                    `}
                                >
                                    <Zap size={24} className={activeTab === 'guide' ? 'fill-current' : ''} />
                                    <span className="text-xs font-bold mt-1">Strategy Guide</span>
                                </button>
                                
                                <button
                                    onClick={() => setActiveTab('checklist')}
                                    className={`
                                        flex flex-col items-center justify-center p-3 rounded-xl transition-colors
                                        ${activeTab === 'checklist' ? 'bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300' : 'text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800'}
                                    `}
                                >
                                    <div className="relative">
                                        <CheckCircle size={24} className={activeTab === 'checklist' ? 'fill-current' : ''} />
                                        {progress > 0 && progress < 100 && (
                                            <span className="absolute -top-1 -right-1 flex h-3 w-3">
                                                <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                                                <span className="relative inline-flex rounded-full h-3 w-3 bg-red-500"></span>
                                            </span>
                                        )}
                                    </div>
                                    <span className="text-xs font-bold mt-1">Checklist</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
